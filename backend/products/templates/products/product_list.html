{% extends 'base.html' %}
{% load static %}
{% block title %}Product list{% endblock %}

{% block content %}
        <!-- breadcrumbs  -->

        <nav class="mx-auto w-full mt-4 max-w-[1200px] px-5">
          <ul class="flex items-center">
            <li class="cursor-pointer">
              <a href="index.html">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                  class="h-5 w-5"
                >
                  <path
                    d="M11.47 3.84a.75.75 0 011.06 0l8.69 8.69a.75.75 0 101.06-1.06l-8.689-8.69a2.25 2.25 0 00-3.182 0l-8.69 8.69a.75.75 0 001.061 1.06l8.69-8.69z"
                  />
                  <path
                    d="M12 5.432l8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 01-.75-.75v-4.5a.75.75 0 00-.75-.75h-3a.75.75 0 00-.75.75V21a.75.75 0 01-.75.75H5.625a1.875 1.875 0 01-1.875-1.875v-6.198a2.29 2.29 0 00.091-.086L12 5.43z"
                  />
                </svg>
              </a>
            </li>
            <li>
              <span class="mx-2 text-gray-500">&gt;</span>
            </li>

            <li class="text-gray-500">Catalog</li>
          </ul>
        </nav>
        <!-- /breadcrumbs  -->
      </div>

      <section
        class="container mx-auto flex-grow max-w-[1200px] border-b py-5 lg:flex lg:flex-row lg:py-10"
      >
        <!-- sidebar  -->
        <section class="hidden w-[300px] flex-shrink-0 px-4 lg:block">

            <form method="get" action="{% url 'product_list' %}">
                <div class="flex border-b pb-5">
                    <div class="w-full">
                        <p class="mb-3 font-medium">CATEGORIES</p>

                        {% for category in categories %}
                            <div class="flex w-full justify-between items-center">
                                <div class="flex items-center">
                                    <div class="h-4 w-4 border rounded mr-2 bg-white flex justify-center items-center">
                                        {% if category.slug == current_category_slug %}
                                            <div class="w-2 h-2 bg-violet-600 rounded-full"></div>
                                        {% endif %}
                                    </div>
                                    <a href="{% url 'product_list_by_category' category.slug %}" class="hover:underline text-gray-800">
                                        {{ category.name }}
                                    </a>
                                </div>
                                <div>
                                    <p class="text-gray-500">({{ category.products.count }})</p>
                                </div>
                            </div>


                        {% endfor %}
 
                    
                    </div>
                </div>

                <button type="submit" class="mt-4 bg-violet-900 text-white px-4 py-2 rounded">Refresh</button>
            </form>


            <div class="flex border-b py-5">
                <div class="w-full">
                <p class="mb-3 font-medium">PRICE</p>

                <div class="flex w-full">
                    <div class="flex justify-between">
                    <input
                        x-mask="99999"
                        min="50"
                        type="number"
                        class="h-8 w-[90px] border pl-2"
                        placeholder="50"
                    />
                    <span class="px-3">-</span>
                    <input
                        x-mask="999999"
                        type="number"
                        max="999999"
                        class="h-8 w-[90px] border pl-2"
                        placeholder="99999"
                    />
                    </div>
                </div>
                </div>
            </div>



            <div class="flex py-5">
                <div class="w-full">
                <p class="mb-3 font-medium">COLOR</p>

                <div class="flex gap-2">
                    <div
                    class="h-8 w-8 cursor-pointer border border-white bg-gray-600 focus:ring-2 focus:ring-gray-500 active:ring-2 active:ring-gray-500"
                    ></div>
                    <div
                    class="h-8 w-8 cursor-pointer border border-white bg-violet-900 focus:ring-2 focus:ring-gray-500 active:ring-2 active:ring-gray-500"
                    ></div>
                    <div
                    class="h-8 w-8 cursor-pointer border border-white bg-red-900 focus:ring-2 focus:ring-gray-500 active:ring-2 active:ring-gray-500"
                    ></div>
                </div>
                </div>
            </div>
        </section>
        <!-- /sidebar  -->

        <div>
          <div class="mb-5 flex items-center justify-between px-5">
            <div class="flex gap-3">
              <button class="flex items-center justify-center border px-6 py-2">
                Sort by
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="1.5"
                  stroke="currentColor"
                  class="mx-2 h-4 w-4"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M19.5 8.25l-7.5 7.5-7.5-7.5"
                  />
                </svg>
              </button>

              <button
                class="flex items-center justify-center border px-6 py-2 md:hidden"
              >
                Filters
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="1.5"
                  stroke="currentColor"
                  class="mx-2 h-4 w-4"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M19.5 8.25l-7.5 7.5-7.5-7.5"
                  />
                </svg>
              </button>
            </div>

            <div class="hidden gap-3 lg:flex">
              <button class="border bg-amber-400 py-2 px-2">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="1.5"
                  stroke="currentColor"
                  class="h-5 w-5"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z"
                  />
                </svg>
              </button>

              <button class="border py-2 px-2">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="1.5"
                  stroke="currentColor"
                  class="h-5 w-5"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zM3.75 12h.007v.008H3.75V12zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm-.375 5.25h.007v.008H3.75v-.008zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"
                  />
                </svg>
              </button>
            </div>
          </div>

        <section class="mx-auto grid max-w-[1200px] grid-cols-2 gap-3 px-5 pb-10 lg:grid-cols-3">
            {% for product in products %}
              <div class="flex flex-col">
                <!-- Image and overlay -->
                <div class="relative flex">
                  <div class="w-72 h-52 bg-gray-100 overflow-hidden flex items-center justify-center">
                    <img 
                      src="{{ product.image.url }}" 
                      alt="{{ product.name }}" 
                      class="object-contain bg-white"
                    >
                  </div>

                  <!-- Hover overlay -->
                  <div class="absolute flex h-full w-full items-center justify-center gap-3 opacity-0 duration-150 hover:opacity-100 bg-black bg-opacity-30">
                    <a href="{% url 'product_detail' product.slug %}" class="flex h-8 w-8 cursor-pointer items-center justify-center rounded-full bg-amber-400">
                      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-4 w-4">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"/>
                      </svg>
                    </a>
                  </div>

                  <!-- Badge -->
                  <div class="absolute top-2 right-2 rounded-full px-3 py-1 text-[0.7rem] font-bold text-white uppercase tracking-wide shadow 
                    {% if product.listing_type == 'exchange' %}
                      bg-amber-500
                    {% else %}
                      bg-green-500
                    {% endif %}">
                    {% if product.listing_type == 'sale' %}
                      Satılık
                    {% else %}
                      Takas
                    {% endif %}
                  </div>
                </div>

                <!-- Product content -->
                <div>
                  <p class="mt-2 font-semibold text-gray-800">{{ product.name }}</p>

                  {% if product.listing_type == 'sale' %}
                    <p class="font-medium text-violet-900">${{ product.price }}</p>
                  {% elif product.listing_type == 'exchange' %}
                    {% if product.exchange_for %}
                      <p class="text-sm text-gray-600 italic">
                        Takas istenen: <span class="font-semibold text-black">{{ product.exchange_for }}</span>
                      </p>
                    {% endif %}
                  {% endif %}

                  <div class="my-5">
                    <a href="{% url 'product_detail' product.slug %}">
                      <button class="h-10 w-full bg-violet-900 text-white hover:bg-violet-800 transition">View Details</button>
                    </a>
                  </div>
                </div>
              </div>
            {% empty %}
              <p class="col-span-3 text-center text-gray-500">No products available.</p>
            {% endfor %}
        </section>
        </div>
      </section>
{% endblock %}